(function(){var t,u=function(a){return!RegExp.prototype.test.call(D,a)},m=function(a){return'"'+a.replace(E,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},q=function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},v=function(a){return String(a).replace(/[&<>"'\/]/g,function(a){return F[a]})},p=function(a){this.tail=this.string=a;this.pos=0},i=function(a,c){this.view=a;this.parent=c;this.clearCache()},f=function(){this.clearCache()},w=function(a,c){for(var b=
['""'],d,r,e=0,g=a.length;e<g;++e)switch(d=a[e],d.type){case "#":case "^":r="#"===d.type?"_section":"_inverted";b.push("r."+r+"("+m(d.value)+", c, function (c, r) {\n  "+w(d.tokens,!0)+"\n})");break;case "{":case "&":case "name":r="name"===d.type?"true":"false";b.push("r._name("+m(d.value)+", c, "+r+")");break;case ">":b.push("r._partial("+m(d.value)+", c)");break;case "text":b.push(m(d.value))}b="return "+b.join(" + ")+";";return c?b:new Function("c, r",b)},x=function(a){if(2===a.length)return[RegExp(q(a[0])+
"\\s*"),RegExp("\\s*"+q(a[1]))];throw Error("Invalid tags: "+a.join(" "));},z=function(a,c){for(var c=c||h.tags,b=x(c),d=new p(a),e=[],f=[],g=!1,i=!1,j,k;!d.eos();){if(k=d.scanUntil(b[0]))for(var m=0,o=k.length;m<o;++m)if(j=k.charAt(m),u(j)?f.push(e.length):i=!0,e.push({type:"text",value:j}),"\n"===j){if(g&&!i)for(;f.length;)e.splice(f.pop(),1);else f=[];i=g=!1}if(!d.scan(b[0]))break;g=!0;j=d.scan(G)||"name";d.scan(H);"="===j?(k=d.scanUntil(y),d.scan(y),d.scanUntil(b[1])):"{"===j?(k=RegExp("\\s*"+
q("}"+c[1])),k=d.scanUntil(k),d.scan(I),d.scanUntil(b[1])):k=d.scanUntil(b[1]);if(!d.scan(b[1]))throw Error("Unclosed tag at "+d.pos);e.push({type:j,value:k});if("name"===j||"{"===j||"&"===j)i=!0;"="===j&&(c=k.split(J),b=x(c))}for(var n,b=0;b<e.length;++b)d=e[b],n&&"text"===n.type&&"text"===d.type?(n.value+=d.value,e.splice(b--,1)):n=d;g=n=[];b=[];for(f=0;f<e.length;++f)switch(d=e[f],d.type){case "#":case "^":d.tokens=[];b.push(d);g.push(d);g=d.tokens;break;case "/":if(0===b.length)throw Error("Unopened section: "+
d.value);g=b.pop();if(g.value!==d.value)throw Error("Unclosed section: "+g.value);g=0<b.length?b[b.length-1].tokens:n;break;default:g.push(d)}if(g=b.pop())throw Error("Unclosed section: "+g.value);return n},A=function(a,c,b){return o.compilePartial(a,c,b)},B=function(a,c,b){if(b)for(var d in b)A(d,b[d]);return o.render(a,c)},h={name:"mustache.js",version:"0.5.2",tags:["{{","}}"]};h.parse=z;h.clearCache=function(){o.clearCache()};h.compile=function(a,c){return o.compile(a,c)};h.compilePartial=A;h.render=
B;h.Scanner=p;h.Context=i;h.Renderer=f;h.to_html=function(a,c,b,d){a=B(a,c,b);if("function"===typeof d)d(a);else return a};var H=/\s*/,J=/\s+/,D=/\S/,y=/\s*=/,I=/\s*\}/,G=/#|\^|\/|>|\{|&|=|!/,s=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},E=/[\x00-\x2F\x3A-\x40\x5B-\x60\x7B-\xFF\u2028\u2029]/gm,F={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};h.isWhitespace=u;h.isArray=s;h.quote=m;h.escapeRe=q;h.escapeHtml=v;p.prototype.eos=function(){return""===
this.tail};p.prototype.scan=function(a){return(a=this.tail.match(a))&&0===a.index?(this.tail=this.tail.substring(a[0].length),this.pos+=a[0].length,a[0]):""};p.prototype.scanUntil=function(a){var c=this.tail.search(a);switch(c){case -1:a=this.tail;this.pos+=this.tail.length;this.tail="";break;case 0:a="";break;default:a=this.tail.substring(0,c),this.tail=this.tail.substring(c),this.pos+=c}return a};i.make=function(a){return a instanceof i?a:new i(a)};i.prototype.clearCache=function(){this._cache=
{}};i.prototype.push=function(a){return new i(a,this)};i.prototype.lookup=function(a){var c=this._cache[a];if(!c){if("."===a)c=this.view;else for(var b=this;b;){if(0<a.indexOf("."))for(var d=a.split("."),e=0,c=b.view;c&&e<d.length;)c=c[d[e++]];else c=b.view[a];if(null!=c)break;b=b.parent}this._cache[a]=c}"function"===typeof c&&(c=c.call(this.view));return c};f.prototype.clearCache=function(){this._cache={};this._partialCache={}};f.prototype.compile=function(a,c){"string"===typeof a&&(a=z(a,c));var b=
w(a),d=this;return function(a){return b(i.make(a),d)}};f.prototype.compilePartial=function(a,c,b){this._partialCache[a]=this.compile(c,b);return this._partialCache[a]};f.prototype.render=function(a,c){var b=this._cache[a];b||(b=this.compile(a),this._cache[a]=b);return b(c)};f.prototype._section=function(a,c,b){a=c.lookup(a);switch(typeof a){case "object":if(s(a)){for(var d="",e=0,f=a.length;e<f;++e)d+=b(c.push(a[e]),this);return d}return a?b(c.push(a),this):"";case "function":var b=b(c,this),g=this;
return a.call(c.view,b,function(a){return g.render(a,c)})||"";default:if(a)return b(c,this)}return""};f.prototype._inverted=function(a,c,b){a=c.lookup(a);return null==a||!1===a||s(a)&&0===a.length?b(c,this):""};f.prototype._partial=function(a,c){var b=this._partialCache[a];return b?b(c):""};f.prototype._name=function(a,c,b){a=c.lookup(a);"function"===typeof a&&(a=a.call(c.view));c=null==a?"":String(a);return b?v(c):c};var o=new f,f=h;"undefined"!==typeof module&&"undefined"!==typeof module.exports?
module.exports=f:"function"===typeof define?define(f):t=f;var C=function(a){return"".trim?a.trim():a.replace(/^\s+/,"").replace(/\s+$/,"")},e={VERSION:"0.10",templates:{},$:"undefined"!==typeof window?window.jQuery||window.Zepto||null:null,addTemplate:function(a,c){if("object"===typeof a)for(var b in a)this.addTemplate(b,a[b]);else e[a]?console.error("Invalid name: "+a+"."):e.templates[a]?console.error('Template "'+a+'  " exists'):(e.templates[a]=c,e[a]=function(b,c){var b=b||{},f=t.to_html(e.templates[a],
b,e.templates);return e.$&&!c?e.$(f):f})},clearAll:function(){for(var a in e.templates)delete e[a];e.templates={}},refresh:function(){e.clearAll();e.grabTemplates()},grabTemplates:function(){var a,c=document.getElementsByTagName("script"),b,d=[];a=0;for(l=c.length;a<l;a++)if((b=c[a])&&b.innerHTML&&b.id&&("text/html"===b.type||"text/x-icanhaz"===b.type))e.addTemplate(b.id,C(b.innerHTML)),d.unshift(b);a=0;for(l=d.length;a<l;a++)d[a].parentNode.removeChild(d[a])},grabExternalTemplate:function(a,c){$.ajax({url:c,
type:"GET",dataType:"text",success:function(b){e.addTemplate(a,C(b))}})}};"undefined"!==typeof require?module.exports=e:window.ich=e;"undefined"!==typeof document&&(e.$?e.$(function(){e.grabTemplates()}):document.addEventListener("DOMContentLoaded",function(){e.grabTemplates()},!0))})();
